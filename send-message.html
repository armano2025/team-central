<script>
  const WEBHOOK_URL = "https://script.google.com/macros/s/AKfycbzpAqiP_91vDFP52UX5NpW2lbCrW1Q7dufw7UZjlEoE7RaFF7Bxz2-e2ZbqdR3Bh6kw0Q/exec";
  const PASSWORD = "Admin1948";

  function getSelectedValues(id) {
    return Array.from(document.getElementById(id).selectedOptions).map(option => option.value);
  }

  function applyFilters() {
    document.getElementById("messageSection").style.display = "block";
  }

  function sendMessage() {
    const password = document.getElementById("password").value;
    if (password !== PASSWORD) {
      alert("סיסמה שגויה");
      return;
    }

    const filters = {
      "Day": getSelectedValues("day"),
      "Subject": getSelectedValues("subject"),
      "Grade": getSelectedValues("grade"),
      "Teacher": getSelectedValues("teacher"),
      "Status": getSelectedValues("status"),
      "Subscription Type": getSelectedValues("subtype")
    };

    const message = document.getElementById("message").value;

    const payload = {
      filters: filters,
      message: message,
      password: password
    };

    fetch(WEBHOOK_URL, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify(payload)
    });

    alert("ההודעה נשלחת...");
  }
</script>